"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7453],{7453:(M,d,c)=>{c.r(d),c.d(d,{PagosPageModule:()=>$});var p=c(177),u=c(4341),i=c(849),f=c(8986),P=c(467),e=c(4438),h=c(1626);let m=(()=>{var t;class a{constructor(o){this.http=o,this.baseUrl="https://abcd1234.ngrok.io/proxy",this.apiKey="5737EF2A-C228-4AA7-AAAE-8F69FC86LF19",this.apiSecret="66e3eaf21090fceff589659881baa31bbd05d36a",this.flowBaseUrl="https://www.flow.cl/api"}makePayment(o){return this.http.post(`${this.flowBaseUrl}/payment/create`,o,{headers:{"Content-Type":"application/json",Authorization:`Basic ${btoa(`${this.apiKey}:${this.apiSecret}`)}`}})}obtenerPagosRecibidos(){const o=`${this.flowBaseUrl}/payment/getTransactions`,n=new h.Lr({Authorization:"Bearer 5737EF2A-C228-4AA7-AAAE-8F69FC86LF19"});return this.http.get(o,{headers:n}).toPromise()}getStatus(o){return this.http.get("https://www.flow.cl/api/payment/getStatus",{params:{s:o},responseType:"text"}).toPromise().then(r=>r).catch(r=>{let l="Unexpected error occurred.";throw l=400===r.status||401===r.status?"Bad request or unauthorized.":r.error instanceof ErrorEvent?`Error: ${r.error.message}`:`Error: ${r.status} - ${r.error}`,new Error(l)})}}return(t=a).\u0275fac=function(o){return new(o||t)(e.KVO(h.Qq))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();function F(t,a){if(1&t&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.k0s()()),2&t){const s=a.$implicit;e.R7$(2),e.JRh(s.nombre),e.R7$(2),e.JRh(s.monto)}}function y(t,a){if(1&t&&(e.j41(0,"ion-list"),e.DNE(1,F,5,2,"ion-item",6),e.k0s()),2&t){const s=e.XpG();e.R7$(),e.Y8G("ngForOf",s.pagosRecibidos)}}function b(t,a){1&t&&e.nrm(0,"ion-spinner")}function R(t,a){1&t&&(e.j41(0,"ion-text",7),e.EFF(1," No se encontraron pagos recibidos. "),e.k0s())}function w(t,a){if(1&t&&(e.j41(0,"div")(1,"p"),e.EFF(2),e.k0s()()),2&t){const s=e.XpG();e.R7$(2),e.SpI("Respuesta: ",s.statusResponse,"")}}function v(t,a){if(1&t&&(e.j41(0,"div")(1,"p"),e.EFF(2),e.k0s()()),2&t){const s=e.XpG();e.R7$(2),e.SpI("Error: ",s.errorMessage,"")}}const E=[{path:"",component:(()=>{var t;class a{constructor(o){this.flowService=o,this.enlaceDePago="https://www.flow.cl/btn.php?token=27mhkwc"}irAPago(){window.location.href=this.enlaceDePago}ngOnInit(){this.obtenerPagosRecibidos()}obtenerPagosRecibidos(){var o=this;return(0,P.A)(function*(){try{const n=yield o.flowService.obtenerPagosRecibidos();o.pagosRecibidos=n.data}catch(n){console.error("Error al obtener los pagos recibidos:",n)}})()}getStatus(){this.flowService.getStatus(this.signature).then(o=>{this.statusResponse=o}).catch(o=>{this.errorMessage=o.message})}}return(t=a).\u0275fac=function(o){return new(o||t)(e.rXU(m))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-pagos"]],decls:18,vars:6,consts:[[1,"boton-pago",3,"click"],[4,"ngIf"],["color","warning",4,"ngIf"],["position","stacked"],["type","text",3,"ngModelChange","ngModel"],["expand","block",3,"click"],[4,"ngFor","ngForOf"],["color","warning"]],template:function(o,n){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"pagos"),e.k0s()()(),e.j41(4,"ion-content")(5,"button",0),e.bIt("click",function(){return n.irAPago()}),e.EFF(6,"Pagar Ahora"),e.k0s(),e.DNE(7,y,2,1,"ion-list",1)(8,b,1,0,"ion-spinner",1)(9,R,2,0,"ion-text",2),e.j41(10,"ion-item")(11,"ion-label",3),e.EFF(12,"Firma:"),e.k0s(),e.j41(13,"ion-input",4),e.mxI("ngModelChange",function(r){return e.DH7(n.signature,r)||(n.signature=r),r}),e.k0s()(),e.j41(14,"ion-button",5),e.bIt("click",function(){return n.getStatus()}),e.EFF(15,"Obtener Estado"),e.k0s(),e.DNE(16,w,3,1,"div",1)(17,v,3,1,"div",1),e.k0s()),2&o&&(e.R7$(7),e.Y8G("ngIf",n.pagosRecibidos&&n.pagosRecibidos.length>0),e.R7$(),e.Y8G("ngIf",!n.pagosRecibidos),e.R7$(),e.Y8G("ngIf",n.pagosRecibidos&&0===n.pagosRecibidos.length),e.R7$(4),e.R50("ngModel",n.signature),e.R7$(3),e.Y8G("ngIf",n.statusResponse),e.R7$(),e.Y8G("ngIf",n.errorMessage))},dependencies:[p.Sq,p.bT,u.BC,u.vS,i.Jm,i.W9,i.eU,i.$w,i.uz,i.he,i.nf,i.w2,i.IO,i.BC,i.ai,i.Gw]}),a})()}];let k=(()=>{var t;class a{}return(t=a).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[f.iI.forChild(E),f.iI]}),a})(),$=(()=>{var t;class a{}return(t=a).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[p.MD,u.YN,i.bv,k]}),a})()}}]);