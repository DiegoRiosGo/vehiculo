"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4776],{4776:(x,d,c)=>{c.r(d),c.d(d,{PagosPageModule:()=>F});var p=c(6814),u=c(95),i=c(9004),f=c(3044),m=c(5861),e=c(6689),h=c(9862);let P=(()=>{var t;class a{constructor(o){this.http=o,this.baseUrl="https://abcd1234.ngrok.io/proxy",this.apiKey="5737EF2A-C228-4AA7-AAAE-8F69FC86LF19",this.apiSecret="66e3eaf21090fceff589659881baa31bbd05d36a",this.flowBaseUrl="https://www.flow.cl/api"}makePayment(o){return this.http.post(`${this.flowBaseUrl}/payment/create`,o,{headers:{"Content-Type":"application/json",Authorization:`Basic ${btoa(`${this.apiKey}:${this.apiSecret}`)}`}})}obtenerPagosRecibidos(){const o=`${this.flowBaseUrl}/payment/getTransactions`,n=new h.WM({Authorization:"Bearer 5737EF2A-C228-4AA7-AAAE-8F69FC86LF19"});return this.http.get(o,{headers:n}).toPromise()}getStatus(o){return this.http.get("https://www.flow.cl/api/payment/getStatus",{params:{s:o},responseType:"text"}).toPromise().then(r=>r).catch(r=>{let l="Unexpected error occurred.";throw l=400===r.status||401===r.status?"Bad request or unauthorized.":r.error instanceof ErrorEvent?`Error: ${r.error.message}`:`Error: ${r.status} - ${r.error}`,new Error(l)})}}return(t=a).\u0275fac=function(o){return new(o||t)(e.LFG(h.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();function y(t,a){if(1&t&&(e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4),e.qZA()()),2&t){const s=a.$implicit;e.xp6(2),e.Oqu(s.nombre),e.xp6(2),e.Oqu(s.monto)}}function b(t,a){if(1&t&&(e.TgZ(0,"ion-list"),e.YNc(1,y,5,2,"ion-item",6),e.qZA()),2&t){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.pagosRecibidos)}}function w(t,a){1&t&&e._UZ(0,"ion-spinner")}function A(t,a){1&t&&(e.TgZ(0,"ion-text",7),e._uU(1," No se encontraron pagos recibidos. "),e.qZA())}function v(t,a){if(1&t&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.qZA()()),2&t){const s=e.oxw();e.xp6(2),e.hij("Respuesta: ",s.statusResponse,"")}}function _(t,a){if(1&t&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.qZA()()),2&t){const s=e.oxw();e.xp6(2),e.hij("Error: ",s.errorMessage,"")}}const T=[{path:"",component:(()=>{var t;class a{constructor(o){this.flowService=o,this.enlaceDePago="https://www.flow.cl/btn.php?token=27mhkwc"}irAPago(){window.location.href=this.enlaceDePago}ngOnInit(){this.obtenerPagosRecibidos()}obtenerPagosRecibidos(){var o=this;return(0,m.Z)(function*(){try{const n=yield o.flowService.obtenerPagosRecibidos();o.pagosRecibidos=n.data}catch(n){console.error("Error al obtener los pagos recibidos:",n)}})()}getStatus(){this.flowService.getStatus(this.signature).then(o=>{this.statusResponse=o}).catch(o=>{this.errorMessage=o.message})}}return(t=a).\u0275fac=function(o){return new(o||t)(e.Y36(P))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-pagos"]],decls:18,vars:6,consts:[[1,"boton-pago",3,"click"],[4,"ngIf"],["color","warning",4,"ngIf"],["position","stacked"],["type","text",3,"ngModel","ngModelChange"],["expand","block",3,"click"],[4,"ngFor","ngForOf"],["color","warning"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"pagos"),e.qZA()()(),e.TgZ(4,"ion-content")(5,"button",0),e.NdJ("click",function(){return n.irAPago()}),e._uU(6,"Pagar Ahora"),e.qZA(),e.YNc(7,b,2,1,"ion-list",1),e.YNc(8,w,1,0,"ion-spinner",1),e.YNc(9,A,2,0,"ion-text",2),e.TgZ(10,"ion-item")(11,"ion-label",3),e._uU(12,"Firma:"),e.qZA(),e.TgZ(13,"ion-input",4),e.NdJ("ngModelChange",function(r){return n.signature=r}),e.qZA()(),e.TgZ(14,"ion-button",5),e.NdJ("click",function(){return n.getStatus()}),e._uU(15,"Obtener Estado"),e.qZA(),e.YNc(16,v,3,1,"div",1),e.YNc(17,_,3,1,"div",1),e.qZA()),2&o&&(e.xp6(7),e.Q6J("ngIf",n.pagosRecibidos&&n.pagosRecibidos.length>0),e.xp6(1),e.Q6J("ngIf",!n.pagosRecibidos),e.xp6(1),e.Q6J("ngIf",n.pagosRecibidos&&0===n.pagosRecibidos.length),e.xp6(4),e.Q6J("ngModel",n.signature),e.xp6(3),e.Q6J("ngIf",n.statusResponse),e.xp6(1),e.Q6J("ngIf",n.errorMessage))},dependencies:[p.sg,p.O5,u.JJ,u.On,i.YG,i.W2,i.Gu,i.pK,i.Ie,i.Q$,i.q_,i.PQ,i.yW,i.wd,i.sr,i.j9]}),a})()}];let Z=(()=>{var t;class a{}return(t=a).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[f.Bz.forChild(T),f.Bz]}),a})(),F=(()=>{var t;class a{}return(t=a).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.ez,u.u5,i.Pc,Z]}),a})()}}]);